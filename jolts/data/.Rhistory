stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x),
geom = 'text',
aes(label = paste(
"P-value = ", signif(..p.value.., digits = 4), sep = ""
)), size = 6, label.x = "left", label.y = "top") +
scale_x_date(date_labels = "%Y", date_breaks = "5 year") +
labs(x = "Time (Years)", y = "Concentration") +
theme_bw() +
theme_brookings() + scale_color_brookings("THP_Categorical_2")+facet_wrap(vars(series))
ggsave("test.png", dpi=300, height=15, width=18, units="in", bg = "white")
ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
geom_line(color = 'black', size = 1.3)  +
# geom_point(color = "blue", size = 1.3) +
stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
color = "blue", fill = "#9AE5D7") +
stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2005-11-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2007-11-01","%Y-%-m-%d"),]) +
stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = FALSE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2018-02-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2020-02-01","%Y-%-m-%d"),]) +
# stat_poly_eq(face = "bold", parse = TRUE, aes(label = ..eq.label..),
#              formula = y ~ x, label.x.npc = 0.5, label.y.npc = 0.1,
#              size = 6, coef.digits = 4) +
# stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x),
#                 geom = 'text',
#                 aes(label = paste(
#                   "P-value = ", signif(..p.value.., digits = 4), sep = ""
#                 )), size = 6, label.x = "left", label.y = "top") +
scale_x_date(date_labels = "%Y", date_breaks = "5 year") +
labs(x = "Time (Years)", y = "Concentration") +
theme_bw() +
theme_brookings() + scale_color_brookings("THP_Categorical_2")+facet_wrap(vars(series))
ggsave("test.png", dpi=300, height=15, width=18, units="in", bg = "white")
ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
geom_line(color = 'black', size = 1.3)  +
# geom_point(color = "blue", size = 1.3) +
stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
color = "blue", fill = "#9AE5D7") +
stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2005-11-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2007-11-01","%Y-%-m-%d"),]) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = FALSE,
#            color = "red", fill = "red", alpha = 0.2,
#           RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2018-02-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2020-02-01","%Y-%-m-%d"),]) +
# stat_poly_eq(face = "bold", parse = TRUE, aes(label = ..eq.label..),
#              formula = y ~ x, label.x.npc = 0.5, label.y.npc = 0.1,
#              size = 6, coef.digits = 4) +
# stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x),
#                 geom = 'text',
#                 aes(label = paste(
#                   "P-value = ", signif(..p.value.., digits = 4), sep = ""
#                 )), size = 6, label.x = "left", label.y = "top") +
scale_x_date(date_labels = "%Y", date_breaks = "2 year", limits=c("2005-11-01","2015-11-01")) +
labs(x = "Time (Years)", y = "Concentration") +
theme_bw() +
theme_brookings() + scale_color_brookings("THP_Categorical_2")+facet_wrap(vars(series))
ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
geom_line(color = 'black', size = 1.3)  +
# geom_point(color = "blue", size = 1.3) +
stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
color = "blue", fill = "#9AE5D7") +
stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2005-11-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2007-11-01","%Y-%-m-%d"),]) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = FALSE,
#            color = "red", fill = "red", alpha = 0.2,
#           RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2018-02-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2020-02-01","%Y-%-m-%d"),]) +
# stat_poly_eq(face = "bold", parse = TRUE, aes(label = ..eq.label..),
#              formula = y ~ x, label.x.npc = 0.5, label.y.npc = 0.1,
#              size = 6, coef.digits = 4) +
# stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x),
#                 geom = 'text',
#                 aes(label = paste(
#                   "P-value = ", signif(..p.value.., digits = 4), sep = ""
#                 )), size = 6, label.x = "left", label.y = "top") +
scale_x_date(date_labels = "%Y", date_breaks = "2 year", limits=c(as.Date("2005-11-01"),as.Date("2015-11-01")) +
labs(x = "Time (Years)", y = "Concentration") +
theme_bw() +
theme_brookings() + scale_color_brookings("THP_Categorical_2")+facet_wrap(vars(series))
ggsave("test.png", dpi=300, height=15, width=18, units="in", bg = "white")
knitr::opts_chunk$set(echo = TRUE)
setwd("C:/Users/sestep/Documents/jolts/")
librarian::shelf(tidyverse, janitor, knitr, ggpmisc)
JOLTS_Rates <- read.csv("C:/Users/sestep/Documents/jolts/data/JOLTS_Rates.csv")
devtools::install_github("mibarnes/ggTHP")
library(ggTHP)
JOLTS_Rates<-JOLTS_Rates%>%clean_names()
industy_openings<-JOLTS_Rates%>%select(date, value, dataelement_text, dataelement_code, industry_code, industry_text, series, group)%>% filter(dataelement_code=="JO", group!="Sizes")%>%
## MONTHLY RECESSIONS ###
mutate(recession = ifelse(
date >= "2001-03-01" & date <= "2007-11-01", "2001", ifelse(
date >= "2007-12-01" & date <= "2020-01-01", "2007-09", ifelse(
date >= "2020-02-01", "2020-21", "OTHER"))))
RAINBOW_Recovery <- industy_openings %>%
filter(recession != "OTHER") %>%
group_by(recession, series) %>%
arrange(date) %>%
mutate(pct_chg = value / first(value)-1) %>%
#filter(pct_chg <= 0) %>%
mutate(Time = 1:n())
RAINBOW_Recovery_mids <- RAINBOW_Recovery %>% filter(Time < 80) %>% group_by(recession, series) %>% filter(Time == mean(Time))
plot.RAINBOW <- RAINBOW_Recovery %>%
#filter(pct_chg <= 0) %>%
ggplot() +
geom_line(aes(x = Time, y = pct_chg, group = recession, color = recession), size = 1.2) +
labs(title = "Recoveries by Business Cycle") +
scale_x_continuous("Months since pre-recession peak", limits = c(0,150)) +
# scale_y_continuous("Percent change from peak", limits = c(-.12,0.30),  breaks = seq(-0.12,0.30, 0.06), expand = c(0,0),
#                    labels = percent_format(accuracy = 4L)) +
theme_brookings() + scale_color_brookings("THP_Categorical_2") +
guides(fill=guide_legend(title="")) +
theme(legend.position = "none",
plot.margin = unit(c(1,1,1.5,1), "cm"))+
geom_label_repel(aes(x= Time, y = pct_chg, group = recession, label = recession, color = recession),
data = subset(RAINBOW_Recovery_mids, series=="Construction")  ,
size = 4, hjust=0, vjust=0,
alpha = 1, segment.alpha = 0,
#segment.color = "grey",
#fill = "grey100",
#nudge_y = .01, nudge_x = 0,
na.rm=TRUE,show.legend = FALSE,seed = 1234)+facet_wrap(vars(series))
ggsave("Rainbow.png", dpi=300, height=15, width=18, units="in", bg = "white")
ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
geom_line(color = 'black', size = 1.3)  +
# geom_point(color = "blue", size = 1.3) +
stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
color = "blue", fill = "#9AE5D7") +
stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2005-11-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2007-11-01","%Y-%-m-%d"),]) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = FALSE,
#            color = "red", fill = "red", alpha = 0.2,
#           RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2018-02-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2020-02-01","%Y-%-m-%d"),]) +
# stat_poly_eq(face = "bold", parse = TRUE, aes(label = ..eq.label..),
#              formula = y ~ x, label.x.npc = 0.5, label.y.npc = 0.1,
#              size = 6, coef.digits = 4) +
# stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x),
#                 geom = 'text',
#                 aes(label = paste(
#                   "P-value = ", signif(..p.value.., digits = 4), sep = ""
#                 )), size = 6, label.x = "left", label.y = "top") +
scale_x_date(date_labels = "%Y", date_breaks = "2 year", limits=c(as.Date("2005-11-01"),as.Date("2015-11-01")) +
labs(x = "Time (Years)", y = "Concentration") +
theme_bw() +
theme_brookings() + scale_color_brookings("THP_Categorical_2")+facet_wrap(vars(series))
ggsave("test.png", dpi=300, height=15, width=18, units="in", bg = "white")
ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
geom_line(color = 'black', size = 1.3)  +
# geom_point(color = "blue", size = 1.3) +
stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
color = "blue", fill = "#9AE5D7") +
stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2005-11-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2007-11-01","%Y-%-m-%d"),]) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = FALSE,
#            color = "red", fill = "red", alpha = 0.2,
#           RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2018-02-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2020-02-01","%Y-%-m-%d"),]) +
# stat_poly_eq(face = "bold", parse = TRUE, aes(label = ..eq.label..),
#              formula = y ~ x, label.x.npc = 0.5, label.y.npc = 0.1,
#              size = 6, coef.digits = 4) +
# stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x),
#                 geom = 'text',
#                 aes(label = paste(
#                   "P-value = ", signif(..p.value.., digits = 4), sep = ""
#                 )), size = 6, label.x = "left", label.y = "top") +
scale_x_date(date_labels = "%Y", date_breaks = "2 year", limits=c(as.Date("2005-11-01"),as.Date("2015-11-01"))) +
labs(x = "Time (Years)", y = "Concentration") +
theme_bw() +
theme_brookings() + scale_color_brookings("THP_Categorical_2")+facet_wrap(vars(series))
ggsave("test.png", dpi=300, height=15, width=18, units="in", bg = "white")
ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
geom_line(color = 'black', size = 1)  +
# geom_point(color = "blue", size = 1.3) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
#             color = "blue", fill = "#9AE5D7") +
stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2005-11-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2007-11-01","%Y-%-m-%d"),]) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = FALSE,
#            color = "red", fill = "red", alpha = 0.2,
#           RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2018-02-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2020-02-01","%Y-%-m-%d"),]) +
# stat_poly_eq(face = "bold", parse = TRUE, aes(label = ..eq.label..),
#              formula = y ~ x, label.x.npc = 0.5, label.y.npc = 0.1,
#              size = 6, coef.digits = 4) +
# stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x),
#                 geom = 'text',
#                 aes(label = paste(
#                   "P-value = ", signif(..p.value.., digits = 4), sep = ""
#                 )), size = 6, label.x = "left", label.y = "top") +
scale_x_date(date_labels = "%Y", date_breaks = "2 year", limits=c(as.Date("2005-11-01"),as.Date("2015-11-01"))) +
labs(x = "Time (Years)", y = "Concentration") +
theme_bw() +
theme_brookings() + scale_color_brookings("THP_Categorical_2")+facet_wrap(vars(series))
ggsave("test.png", dpi=300, height=15, width=18, units="in", bg = "white")
ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
geom_line(color = 'black', size = 1)  +facet_wrap(vars(series))+
# geom_point(color = "blue", size = 1.3) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
#             color = "blue", fill = "#9AE5D7") +
stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2005-11-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2007-11-01","%Y-%-m-%d"),]) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = FALSE,
#            color = "red", fill = "red", alpha = 0.2,
#           RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2018-02-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2020-02-01","%Y-%-m-%d"),]) +
# stat_poly_eq(face = "bold", parse = TRUE, aes(label = ..eq.label..),
#              formula = y ~ x, label.x.npc = 0.5, label.y.npc = 0.1,
#              size = 6, coef.digits = 4) +
# stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x),
#                 geom = 'text',
#                 aes(label = paste(
#                   "P-value = ", signif(..p.value.., digits = 4), sep = ""
#                 )), size = 6, label.x = "left", label.y = "top") +
scale_x_date(date_labels = "%Y", date_breaks = "2 year", limits=c(as.Date("2005-11-01"),as.Date("2015-11-01"))) +
labs(x = "Time (Years)", y = "Concentration") +
theme_bw() +
theme_brookings() + scale_color_brookings("THP_Categorical_2")
ggsave("test.png", dpi=300, height=15, width=18, units="in", bg = "white")
ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
geom_line(color = 'black', size = 1)  +facet_wrap(vars(series))+
# geom_point(color = "blue", size = 1.3) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
#             color = "blue", fill = "#9AE5D7") +
stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2005-11-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2007-11-01","%Y-%-m-%d"),]) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = FALSE,
#            color = "red", fill = "red", alpha = 0.2,
#           RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2018-02-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2020-02-01","%Y-%-m-%d"),]) +
stat_poly_eq(face = "bold", parse = TRUE) +
stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x),
geom = 'text')
ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
geom_line(color = 'black', size = 1)  +facet_wrap(vars(series))+
# geom_point(color = "blue", size = 1.3) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
#             color = "blue", fill = "#9AE5D7") +
stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2005-11-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2007-11-01","%Y-%-m-%d"),]) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = FALSE,
#            color = "red", fill = "red", alpha = 0.2,
#           RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2018-02-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2020-02-01","%Y-%-m-%d"),]) +
stat_poly_eq(face = "bold", parse = TRUE, aes(label = ..eq.label..),
formula = y ~ x, label.x.npc = 0.5, label.y.npc = 0.1,
size = 6, coef.digits = 4) +
stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x),
geom = 'text',
aes(label = paste(
"P-value = ", signif(..p.value.., digits = 4), sep = ""
)), size = 6, label.x = "left", label.y = "top") +
scale_x_date(date_labels = "%Y", date_breaks = "2 year", limits=c(as.Date("2005-11-01"),as.Date("2015-11-01"))) +
labs(x = "Time (Years)", y = "Concentration") +
theme_bw() +
theme_brookings() + scale_color_brookings("THP_Categorical_2")
ggsave("test.png", dpi=300, height=15, width=18, units="in", bg = "white")
ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
geom_line(color = 'black', size = 1)  +facet_wrap(vars(series))+
# geom_point(color = "blue", size = 1.3) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
#             color = "blue", fill = "#9AE5D7") +
stat_smooth(method = "lm", fullrange = FALSE, formula = y ~ x, size = 0.75, se = TRUE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2005-11-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2007-11-01","%Y-%-m-%d"),]) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = FALSE,
#            color = "red", fill = "red", alpha = 0.2,
#           RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2018-02-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2020-02-01","%Y-%-m-%d"),]) +
# stat_poly_eq(face = "bold", parse = TRUE, aes(label = ..eq.label..),
#              formula = y ~ x, label.x.npc = 0.5, label.y.npc = 0.1,
#              size = 6, coef.digits = 4) +
# stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x),
#                 geom = 'text',
#                 aes(label = paste(
#                   "P-value = ", signif(..p.value.., digits = 4), sep = ""
#                 )), size = 6, label.x = "left", label.y = "top") +
scale_x_date(date_labels = "%Y", date_breaks = "2 year", limits=c(as.Date("2005-11-01"),as.Date("2015-11-01"))) +
labs(x = "Time (Years)", y = "Concentration") +
theme_brookings() + scale_color_brookings("THP_Categorical_2")
ggsave("test.png", dpi=300, height=15, width=18, units="in", bg = "white")
ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
geom_line(color = 'black', size = 1)  +facet_wrap(vars(series))+
# geom_point(color = "blue", size = 1.3) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
#             color = "blue", fill = "#9AE5D7") +
stat_smooth(method = "lm", fullrange = FALSE, formula = y ~ x, size = 0.5, se = FALSE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2005-11-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2007-11-01","%Y-%-m-%d"),]) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = FALSE,
#            color = "red", fill = "red", alpha = 0.2,
#           RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2018-02-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2020-02-01","%Y-%-m-%d"),]) +
# stat_poly_eq(face = "bold", parse = TRUE, aes(label = ..eq.label..),
#              formula = y ~ x, label.x.npc = 0.5, label.y.npc = 0.1,
#              size = 6, coef.digits = 4) +
# stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x),
#                 geom = 'text',
#                 aes(label = paste(
#                   "P-value = ", signif(..p.value.., digits = 4), sep = ""
#                 )), size = 6, label.x = "left", label.y = "top") +
scale_x_date(date_labels = "%Y", date_breaks = "2 year", limits=c(as.Date("2005-11-01"),as.Date("2015-11-01"))) +
labs(x = "Time (Years)", y = "openings rate") +
theme_brookings() + scale_color_brookings("THP_Categorical_2")
ggsave("test.png", dpi=300, height=15, width=18, units="in", bg = "white")
GR<-ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
geom_line(color = 'black', size = 1)  +facet_wrap(vars(series))+
# geom_point(color = "blue", size = 1.3) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
#             color = "blue", fill = "#9AE5D7") +
stat_smooth(method = "lm", fullrange = FALSE, formula = y ~ x, size = 0.5, se = FALSE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2005-11-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2007-11-01","%Y-%-m-%d"),]) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = FALSE,
#            color = "red", fill = "red", alpha = 0.2,
#           RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2018-02-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2020-02-01","%Y-%-m-%d"),]) +
# stat_poly_eq(face = "bold", parse = TRUE, aes(label = ..eq.label..),
#              formula = y ~ x, label.x.npc = 0.5, label.y.npc = 0.1,
#              size = 6, coef.digits = 4) +
# stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x),
#                 geom = 'text',
#                 aes(label = paste(
#                   "P-value = ", signif(..p.value.., digits = 4), sep = ""
#                 )), size = 6, label.x = "left", label.y = "top") +
scale_x_date(date_labels = "%Y", date_breaks = "2 year", limits=c(as.Date("2005-11-01"),as.Date("2015-11-01"))) +
labs(x = "Time (Years)", y = "openings rate") +
theme_brookings() + scale_color_brookings("THP_Categorical_2")
ggsave("GR_fit.png", dpi=300, height=15, width=18, units="in", bg = "white")
Covid<-ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
geom_line(color = 'black', size = 1)  +facet_wrap(vars(series))+
# geom_point(color = "blue", size = 1.3) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
#             color = "blue", fill = "#9AE5D7") +
# stat_smooth(method = "lm", fullrange = FALSE, formula = y ~ x, size = 0.5, se = FALSE,
#             color = "red", fill = "red", alpha = 0.2,
#            RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2005-11-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2007-11-01","%Y-%-m-%d"),]) +
stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = FALSE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2018-02-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2020-02-01","%Y-%-m-%d"),]) +
# stat_poly_eq(face = "bold", parse = TRUE, aes(label = ..eq.label..),
#              formula = y ~ x, label.x.npc = 0.5, label.y.npc = 0.1,
#              size = 6, coef.digits = 4) +
# stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x),
#                 geom = 'text',
#                 aes(label = paste(
#                   "P-value = ", signif(..p.value.., digits = 4), sep = ""
#                 )), size = 6, label.x = "left", label.y = "top") +
scale_x_date(date_labels = "%Y", date_breaks = "2 year", limits=c(as.Date("2018-02-01"),as.Date("2022-04-01"))) +
labs(x = "Time (Years)", y = "openings rate") +
theme_brookings() + scale_color_brookings("THP_Categorical_2")
ggsave("Covid_fit.png", dpi=300, height=15, width=18, units="in", bg = "white")
GR<-ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
labs(title = "Great Recession") +
geom_line(color = 'black', size = 1)  +facet_wrap(vars(series))+
# geom_point(color = "blue", size = 1.3) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
#             color = "blue", fill = "#9AE5D7") +
stat_smooth(method = "lm", fullrange = FALSE, formula = y ~ x, size = 0.5, se = FALSE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2005-11-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2007-11-01","%Y-%-m-%d"),]) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = FALSE,
#            color = "red", fill = "red", alpha = 0.2,
#           RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2018-02-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2020-02-01","%Y-%-m-%d"),]) +
# stat_poly_eq(face = "bold", parse = TRUE, aes(label = ..eq.label..),
#              formula = y ~ x, label.x.npc = 0.5, label.y.npc = 0.1,
#              size = 6, coef.digits = 4) +
# stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x),
#                 geom = 'text',
#                 aes(label = paste(
#                   "P-value = ", signif(..p.value.., digits = 4), sep = ""
#                 )), size = 6, label.x = "left", label.y = "top") +
scale_x_date(date_labels = "%Y", date_breaks = "2 year", limits=c(as.Date("2005-11-01"),as.Date("2015-11-01"))) +
labs(x = "Time (Years)", y = "openings rate") +
theme_brookings() + scale_color_brookings("THP_Categorical_2")
ggsave("GR_fit.png", dpi=300, height=15, width=18, units="in", bg = "white")
Covid<-ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
geom_line(color = 'black', size = 1)  +facet_wrap(vars(series))+
labs(title = "COVID-19 Recession") +
# geom_point(color = "blue", size = 1.3) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
#             color = "blue", fill = "#9AE5D7") +
# stat_smooth(method = "lm", fullrange = FALSE, formula = y ~ x, size = 0.5, se = FALSE,
#             color = "red", fill = "red", alpha = 0.2,
#            RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2005-11-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2007-11-01","%Y-%-m-%d"),]) +
stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = FALSE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2018-02-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2020-02-01","%Y-%-m-%d"),]) +
# stat_poly_eq(face = "bold", parse = TRUE, aes(label = ..eq.label..),
#              formula = y ~ x, label.x.npc = 0.5, label.y.npc = 0.1,
#              size = 6, coef.digits = 4) +
# stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x),
#                 geom = 'text',
#                 aes(label = paste(
#                   "P-value = ", signif(..p.value.., digits = 4), sep = ""
#                 )), size = 6, label.x = "left", label.y = "top") +
scale_x_date(date_labels = "%Y", date_breaks = "2 year", limits=c(as.Date("2018-02-01"),as.Date("2022-04-01"))) +
labs(x = "Time (Years)", y = "openings rate") +
theme_brookings() + scale_color_brookings("THP_Categorical_2")
ggsave("Covid_fit.png", dpi=300, height=15, width=18, units="in", bg = "white")
GR<-ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
labs(title = "Great Recession") +
geom_line(color = 'black', size = 1)  +facet_wrap(vars(series))+
# geom_point(color = "blue", size = 1.3) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
#             color = "blue", fill = "#9AE5D7") +
stat_smooth(method = "lm", fullrange = FALSE, formula = y ~ x, size = 0.5, se = FALSE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2005-11-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2007-11-01","%Y-%-m-%d"),]) +
scale_x_date(date_labels = "%Y", date_breaks = "2 year", limits=c(as.Date("2007-12-01"),as.Date("2015-11-01"))) +
labs(x = "Time (Years)", y = "openings rate") +
theme_brookings() + scale_color_brookings("THP_Categorical_2")
ggsave("GR_fit.png", dpi=300, height=15, width=18, units="in", bg = "white")
Covid<-ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
geom_line(color = 'black', size = 1)  +facet_wrap(vars(series))+
labs(title = "COVID-19 Recession") +
stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = FALSE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2018-02-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2020-02-01","%Y-%-m-%d"),]) +
scale_x_date(date_labels = "%Y", date_breaks = "2 year", limits=c(as.Date("2020-03-01"),as.Date("2022-04-01"))) +
labs(x = "Time (Years)", y = "openings rate") +
theme_brookings() + scale_color_brookings("THP_Categorical_2")
ggsave("Covid_fit.png", dpi=300, height=15, width=18, units="in", bg = "white")
GR<-ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
labs(title = "Great Recession") +
geom_line(color = 'black', size = 1)  +facet_wrap(vars(series))+
# geom_point(color = "blue", size = 1.3) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
#             color = "blue", fill = "#9AE5D7") +
stat_smooth(method = "lm", fullrange = FALSE, formula = y ~ x, size = 0.5, se = FALSE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2005-11-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2007-11-01","%Y-%-m-%d"),]) +
scale_x_date(date_labels = "%Y", date_breaks = "2 year", limits=c(as.Date("2007-12-01"),as.Date("2015-11-01"))) +
labs(x = "Time (Years)", y = "openings rate") +
theme_brookings() + scale_color_brookings("THP_Categorical_2")
ggsave("GR_fit.png", dpi=300, height=15, width=18, units="in", bg = "white")
Covid<-ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
geom_line(color = 'black', size = 1)  +facet_wrap(vars(series))+
labs(title = "COVID-19 Recession") +
stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = FALSE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2018-02-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2020-02-01","%Y-%-m-%d"),]) +
scale_x_date(date_labels = "%Y-%-m", date_breaks = "6 month", limits=c(as.Date("2020-03-01"),as.Date("2022-04-01"))) +
labs(x = "Time (Years)", y = "openings rate") +
theme_brookings() + scale_color_brookings("THP_Categorical_2")
ggsave("Covid_fit.png", dpi=300, height=15, width=18, units="in", bg = "white")
GR<-ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
labs(title = "Great Recession") +
geom_line(color = 'black', size = 1)  +facet_wrap(vars(series))+
# geom_point(color = "blue", size = 1.3) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
#             color = "blue", fill = "#9AE5D7") +
stat_smooth(method = "lm", fullrange = FALSE, formula = y ~ x, size = 0.5, se = FALSE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2005-11-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2007-11-01","%Y-%-m-%d"),]) +
scale_x_date(date_labels = "%Y", date_breaks = "2 year", limits=c(as.Date("2007-12-01"),as.Date("2015-11-01"))) +
labs(x = "Time (Years)", y = "openings rate") +
theme_brookings() + scale_color_brookings("THP_Categorical_2")
ggsave("GR_fit.png", dpi=300, height=15, width=18, units="in", bg = "white")
Covid<-ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
geom_line(color = 'black', size = 1)  +facet_wrap(vars(series))+
labs(title = "COVID-19 Recession") +
stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = FALSE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2018-02-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2020-02-01","%Y-%-m-%d"),]) +
scale_x_date(date_labels = "%Y-%m", date_breaks = "6 month", limits=c(as.Date("2020-03-01"),as.Date("2022-04-01"))) +
labs(x = "Time (Years)", y = "openings rate") +
theme_brookings() + scale_color_brookings("THP_Categorical_2")
ggsave("Covid_fit.png", dpi=300, height=15, width=18, units="in", bg = "white")
GR<-ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
labs(title = "Great Recession") +
geom_line(color = 'black', size = 1)  +facet_wrap(vars(series))+
# geom_point(color = "blue", size = 1.3) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
#             color = "blue", fill = "#9AE5D7") +
stat_smooth(method = "lm", fullrange = FALSE, formula = y ~ x, size = 0.5, se = FALSE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2005-11-01","%Y-%m-%d") & RAINBOW_Recovery$date <= as.Date("2007-11-01","%Y-%m-%d"),]) +
scale_x_date(date_labels = "%Y", date_breaks = "2 year", limits=c(as.Date("2007-12-01"),as.Date("2015-11-01"))) +
labs(x = "Time (Years)", y = "openings rate") +
theme_brookings() + scale_color_brookings("THP_Categorical_2")
ggsave("GR_fit.png", dpi=300, height=15, width=18, units="in", bg = "white")
Covid<-ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
geom_line(color = 'black', size = 1)  +facet_wrap(vars(series))+
labs(title = "COVID-19 Recession") +
stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = FALSE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2018-02-01","%Y-%-m-%d") & RAINBOW_Recovery$date <= as.Date("2020-02-01","%Y-%-m-%d"),]) +
scale_x_date(date_labels = "%Y-%m", date_breaks = "6 month", limits=c(as.Date("2020-03-01"),as.Date("2022-04-01"))) +
labs(x = "Time (Years)", y = "openings rate") +
theme_brookings() + scale_color_brookings("THP_Categorical_2")
ggsave("Covid_fit.png", dpi=300, height=15, width=18, units="in", bg = "white")
GR<-ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
labs(title = "Great Recession") +
geom_line(color = 'black', size = 1)  +facet_wrap(vars(series))+
# geom_point(color = "blue", size = 1.3) +
# stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = TRUE,
#             color = "blue", fill = "#9AE5D7") +
stat_smooth(method = "lm", fullrange = FALSE, formula = y ~ x, size = 0.5, se = FALSE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2005-11-01","%Y-%m-%d") & RAINBOW_Recovery$date <= as.Date("2007-11-01","%Y-%m-%d"),]) +
scale_x_date(date_labels = "%Y", date_breaks = "2 year", limits=c(as.Date("2007-12-01"),as.Date("2015-11-01"))) +
labs(x = "Time (Years)", y = "openings rate") +
theme_brookings() + scale_color_brookings("THP_Categorical_2")
ggsave("GR_fit.png", dpi=300, height=15, width=18, units="in", bg = "white")
Covid<-ggplot(RAINBOW_Recovery, aes(x = as.Date(date, "%Y-%m-%d"), y = value)) +
geom_line(color = 'black', size = 1)  +facet_wrap(vars(series))+
labs(title = "COVID-19 Recession") +
stat_smooth(method = "lm", formula = y ~ x, size = 0.75, se = FALSE,
color = "red", fill = "red", alpha = 0.2,
RAINBOW_Recovery = RAINBOW_Recovery[RAINBOW_Recovery$date >= as.Date("2018-02-01","%Y-%m-%d") & RAINBOW_Recovery$date <= as.Date("2020-02-01","%Y-%m-%d"),]) +
scale_x_date(date_labels = "%Y-%m", date_breaks = "6 month", limits=c(as.Date("2020-03-01"),as.Date("2022-04-01"))) +
labs(x = "Time (Years)", y = "openings rate") +
theme_brookings() + scale_color_brookings("THP_Categorical_2")
ggsave("Covid_fit.png", dpi=300, height=15, width=18, units="in", bg = "white")
